(function(){function e(){var e=arguments;return e[0].replace(/{(\d+)}/g,function(t,n){var r=parseInt(n);return r>=0&&r<e.length-1?e[r+1]:""})}function t(t,n,r){t=t.split(/[()]/);var i=t[0],s,o="";if(t.length>1)s=t[1].split(/\s*,\s*/);switch(i){case"rectangle":var u="",a="";if(s.length>4){u="rx='"+s[4]+"'";a="ry='"+(s.length>5?s[5]:s[4])+"'"}o=e("<rect x='{0}' y='{1}' width='{2}' height='{3}' {4} {5} />",s[0],s[1],s[2],s[3],u,a);break;case"circle":o=e("<circle cx='{0}' cy='{1}' r='{2} />",s[0],s[1],s[2]);break;case"ellipse":o=e("<ellipse cx='{0}' cy='{1}' rx='{2}' ry='{3}' />",s[0],s[1],s[2],s[3]);break;case"polygon":var f=s[0].search(/nonzero|evenodd/i)>=0?s.shift():"nonzero";var l=s.map(function(e,t,r){e=e.replace(/\s+/,",");e=e.replace(/(-?\d+(?:\.\d+)?)(px|%)/g,function(e,t,r,i){var s=parseFloat(t);switch(r){case"%":s*=(i?n.offsetHeight:n.offsetWidth)/100;case"px":default:}return s.toString()});return e});l=l.join(" ");o=e("<polygon fill-rule='{0}' points='{1}' />",f,l);break;default:return null}return"<svg xmlns='http://www.w3.org/2000/svg' style='display:block' width='100%' height='100%'><g fill='blue'>"+o+"</g></svg>"}function n(e,n,r){var i=t(r,e,n);if(!i)return;if(n.getPropertyValue("position")=="static")e.style.setProperty("position","relative");var s=document.createElement("div");s.setAttribute("class","shape-bookmarklet-overlay");s.setAttribute("style","width:100%;height:100%;position:absolute;top:0;left:0;opacity:0.5");s.innerHTML=i;e.appendChild(s)}function r(t,n,r){t=t.split(/[()]/);var i=t[0];var s=t[1].split(/\s*,\s*/);var o,u,a,f;var l="";switch(i){case"rectangle":var c="",h="";if(s.length>4){c="rx='"+s[4]+"'";h="ry='"+(s.length>5?s[5]:s[4])+"'"}o=s[0];u=s[1];a=s[2];f=s[3];l=e("<rect x='0' y='0' width='100%' height='100%' {1} {2} />",c,h);break;case"circle":var p=s[0].match(/(\d+)(\D+)/)[1];var d=s[1].match(/(\d+)(\D+)/)[1];var v=s[2].match(/(\d+)(\D+)/)[1];var m=s[0].match(/(\d+)(\D+)/)[2];o=e("{0}{1}",p-v,m);u=e("{0}{1}",d-v,m);a=e("{0}{1}",2*v,m);f=e("{0}{1}",2*v,m);l="<circle cx='50%' cy='50%' r='50%' />";break;case"ellipse":var p=s[0].match(/(\d+)(\D+)/)[1];var d=s[1].match(/(\d+)(\D+)/)[1];var c=s[2].match(/(\d+)(\D+)/)[1];var h=s[3].match(/(\d+)(\D+)/)[1];var m=s[0].match(/(\d+)(\D+)/)[2];o=e("{0}{1}",p-c,m);u=e("{0}{1}",d-h,m);a=e("{0}{1}",2*c,m);f=e("{0}{1}",2*h,m);l="<ellipse cx='50%' cy='50%' rx='50%' ry='50%' />";break;case"polygon":o=u=a=f=0;var g=s[0].search(/nonzero|evenodd/i)>=0?s.shift():"nonzero";var y=s.map(function(e,t,r){e=e.replace(/\s+/,",");e=e.replace(/(-?\d+(?:\.\d+)?)(px|%)/g,function(e,t,r,i){var s=parseFloat(t);switch(r){case"%":s*=(i?n.offsetHeight:n.offsetWidth)/100;case"px":default:}if(i){if(u>s)u=s;if(f<s)f=s}else{if(o>s)o=s;if(a<s)a=s}return s.toString()});return e});f-=u;a-=o;y.forEach(function(e,t,n){e=e.replace(/(-?\d+(?:\.\d+)?)/g,function(e,t,n){var r=parseFloat(t);r-=n?u:o;return r.toString()});n[t]=e});o=o+"px";u=u+"px";a=a+"px";f=f+"px";y=y.join(" ");l=e("<polygon fill-rule='{0}' points='{1}' />",g,y);break;default:}var b=document.createElement("div");b.setAttribute("class","shape-bookmarklet-overlay");b.setAttribute("style",e("width:{0};height:{1};position:absolute;top:{2};left:{3};opacity:0.5",a,f,u,o));b.innerHTML="<svg xmlns='http://www.w3.org/2000/svg' style='display:block' width='100%' height='100%'><g fill='blue'>"+l+"</g></svg>";n.appendChild(b)}function i(e,t,n){if(t.getPropertyValue("position")=="static")e.style.setProperty("position","relative");e.style.setProperty("overflow","visible");r(n,e,t)}function s(){var e=document.getElementsByTagName("*");for(var t=0;t<e.length;t++){var r=e[t];var s=getComputedStyle(r);if(!s)return;var o=s.getPropertyValue("-webkit-shape-inside");if(o=="outside-shape")o=s.getPropertyValue("-webkit-shape-outside");if(o!="auto")n(r,s,o);var u=s.getPropertyValue("-webkit-shape-outside");if(u!="auto")i(r,s,u)}}function u(){s();o=true}function a(){var e=document.getElementsByClassName("shape-bookmarklet-overlay");while(e.length){var t=e[0];t.parentNode.removeChild(t)}o=false}var o=false;!function(){window.showShapesBookmarklet=function(){o?a():u()};u()}()})()
